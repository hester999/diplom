events {}

http {
    include mime.types;
    default_type application/octet-stream;

    server {
        listen 80;

        # ✅ Главная страница
        location / {
            root /app/templates;  # Указываем путь к index.html
            index index.html;
        }

        # ✅ Проксирование API для SQL-инъекций
        location /sql-injection/ {
            proxy_pass http://sql-injection:5000/sql-injection/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
        }

        # ✅ Раздача статики для SQL-инъекций
        location /sql-injection/static/ {
            root /app/SQL/;  # Исправленный путь к статику SQL
            autoindex on;
            expires max;
        }

        # ✅ Раздача статики для XSS
        location /xss/static/ {
            root /app/xss/;
            autoindex on;
            expires max;
        }

        # ✅ Раздача статики для CSRF
        location /csrf/static/ {
            root /app/csrf/;
            autoindex on;
            expires max;
        }

        # ✅ Раздача статики для File Upload
        location /file-upload/static/ {
            root /app/file-upload/;
            autoindex on;
            expires max;
        }

        # ✅ Глобальная раздача статики (CSS, JS, изображения)
        location /static/ {
            root /templates/;  # Теперь берет статику из главной папки
            expires 6M;
            access_log off;
            add_header Cache-Control "public, max-age=31536000, immutable";
        }
    }
}
