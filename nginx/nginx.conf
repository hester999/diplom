events {}

http {
    include mime.types;
    default_type application/octet-stream;

    server {
        listen 80;

        # ✅ Главная страница
        location / {
            root /app/templates;   # Путь к index.html
            index index.html;
        }

        # ✅ Проксирование API для SQL-инъекций
        location /sql-injection/ {
            proxy_pass http://sql-injection:5000/sql-injection/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
        }

        # ✅ Раздача статики для SQL-инъекций
        location /sql-injection/static/ {
            alias /app/templates/SQL/;
            expires max;
        }

        # ✅ Проксирование API для XSS
        location /xss/ {
            proxy_pass http://xss_service:5000/xss/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
        }

        # ✅ Раздача статики для XSS
        location /xss/static/ {
            alias /app/templates/xss/;
            expires max;
        }

#         # ✅ Проксирование API для CSRF
#         location /csrf/ {
#             proxy_pass http://csrf_service:5000/csrf/;
#             proxy_set_header Host $host;
#             proxy_set_header X-Real-IP $remote_addr;
#         }
#
#         # ✅ Раздача статики для CSRF
#         location /csrf/static/ {
#             alias /app/csrf/static/;
#             expires max;
#         }
#
#         # ✅ Проксирование API для File Upload
#         location /file-upload/ {
#             proxy_pass http://file_upload_service:5000/file-upload/;
#             proxy_set_header Host $host;
#             proxy_set_header X-Real-IP $remote_addr;
#         }
#
#         # ✅ Раздача статики для File Upload
#         location /file-upload/static/ {
#             alias /app/file-upload/static/;
#             expires max;
#        }

        # ✅ Глобальная раздача статических файлов (CSS, JS, изображения)
        location ~* \.(?:css|js|ico|png|jpg|jpeg|gif|svg)$ {
            root /app/templates;
            expires 6M;
            access_log off;
            add_header Cache-Control "public, max-age=31536000, immutable";
        }
    }
}
